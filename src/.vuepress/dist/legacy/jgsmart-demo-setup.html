<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JGSmart Demo Deployment Process | Iris Technical Documentation</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Iris technical documentation">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.e95371f8.css" as="style"><link rel="preload" href="/assets/js/app.d9661c25.js" as="script"><link rel="preload" href="/assets/js/2.d35fa273.js" as="script"><link rel="preload" href="/assets/js/13.4ac1dcd4.js" as="script"><link rel="prefetch" href="/assets/js/10.2a7eca81.js"><link rel="prefetch" href="/assets/js/11.8bf06d4d.js"><link rel="prefetch" href="/assets/js/12.a9342712.js"><link rel="prefetch" href="/assets/js/14.dddd6df1.js"><link rel="prefetch" href="/assets/js/15.3404b568.js"><link rel="prefetch" href="/assets/js/16.0868c9e5.js"><link rel="prefetch" href="/assets/js/3.0277475e.js"><link rel="prefetch" href="/assets/js/4.bf905f50.js"><link rel="prefetch" href="/assets/js/5.44066470.js"><link rel="prefetch" href="/assets/js/6.ffe6f60a.js"><link rel="prefetch" href="/assets/js/7.a00e933e.js"><link rel="prefetch" href="/assets/js/8.94f9e596.js"><link rel="prefetch" href="/assets/js/9.2250d602.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e95371f8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Iris Technical Documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/setup/" class="nav-link">
  Setup
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/setup/" class="nav-link">
  Setup
</a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="jgsmart-demo-deployment-process"><a href="#jgsmart-demo-deployment-process" class="header-anchor">#</a> JGSmart Demo Deployment Process</h1> <p>This is a small guide covering the different steps that have to be followed to deploy and launch the Smart Demo. The demo is hosted on a virtual machine running Ubuntu.</p> <h2 id="before-we-begin"><a href="#before-we-begin" class="header-anchor">#</a> Before we begin</h2> <p>The deployment process relies heavily on the <code>screen</code> command available on Linux. It is recommended to skim its <a href="https://www.gnu.org/software/screen/manual/screen.html" target="_blank" rel="noopener noreferrer">documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to get the hang of it, especially the <a href="https://www.gnu.org/software/screen/manual/screen.html#Invoking-Screen" target="_blank" rel="noopener noreferrer">Invoking Screen<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> section.</p> <p>Anyway, the main commands are:</p> <ol><li>Start and attach a new session with name [SESSION_NAME]<div class="language- extra-class"><pre class="language-text"><code>screen -S [SESSION_NAME]
</code></pre></div></li> <li>Dettach current session<div class="language- extra-class"><pre class="language-text"><code>Ctrl+A+D
</code></pre></div></li> <li>List all sessions<div class="language- extra-class"><pre class="language-text"><code>screen -ls
</code></pre></div></li> <li>Reattach a dettached session<div class="language- extra-class"><pre class="language-text"><code>screen -r [SESSION_NAME]
</code></pre></div></li></ol> <p>A part from that, basic knowledge of Linux commands and Vim is recommended.</p> <h2 id="connect-to-the-virtual-machine-via-ssh"><a href="#connect-to-the-virtual-machine-via-ssh" class="header-anchor">#</a> Connect to the Virtual Machine via SSH</h2> <p>Open a new terminal and connect via SSH to the Virtual Machine where the demo code is hosted.</p> <div class="language- extra-class"><pre class="language-text"><code>ssh user@jgsmart.jgingenieros.es
</code></pre></div><p>Password: <code>123JGSmart456</code></p> <h2 id="start-docker-containers"><a href="#start-docker-containers" class="header-anchor">#</a> Start Docker Containers</h2> <p>Once inside the Virtual Machine the first step is to start the required containers. To do so run the next commands</p> <div class="language- extra-class"><pre class="language-text"><code>$ screen -S docker
$ cd ~/dev/dev-env/docker-env
$ sudo docker-compose -f docker-compose.yaml -p jgsmart up --remove-orphans
</code></pre></div><p>If there is any error, kill the process and try running the <code>docker-compose</code> command again. This should spin up 4 containers, one running NATS and 3 running Mongo. If everything goes ok press <code>Ctrl+A+D</code> to dettach the terminal session and go back to the main terminal session.</p> <h2 id="start-solution-apis-and-integrators"><a href="#start-solution-apis-and-integrators" class="header-anchor">#</a> Start solution APIs and Integrators</h2> <p>Once the containers are running it is time to run the different solutions. The solutions are located at <code>~/dev/@jgsmart</code>. For practicality reasons it is recomended to change directory to <code>@jgsmart</code>.</p> <div class="language- extra-class"><pre class="language-text"><code>$ cd ~/dev/@jgsmart
</code></pre></div><p>From all the folders inside <code>@jgsmart</code>, which can be listed via <code>ls</code>, the solutions that have to be started are: <code>ako-iot</code>, <code>forge</code>, <code>google-calendar</code>, <code>jgpresence</code>, <code>manttest</code> and <code>wibeee</code>.</p> <p><strong>For each of these solutions</strong> both the  <code>api</code> and the <code>integrator</code> projects have to be started. To do so, the generic procedure goes as follows. First <code>cd</code> into the main solution folder</p> <div class="language- extra-class"><pre class="language-text"><code>$ cd [SOLNAME]
</code></pre></div><p>After that, start a new screen session for the api, <code>cd</code> into the api folder and launch the process via <code>npm run start</code>.</p> <div class="language- extra-class"><pre class="language-text"><code>$ screen -S [SOLNAME]-api
$ cd api
$ npm run start
</code></pre></div><p>Exit the screen session with <code>Ctrl+A+D</code> and start a new screen session for the integrator, <code>cd</code> into the integrator folder and launch the process via <code>npm run start</code>.</p> <div class="language- extra-class"><pre class="language-text"><code>$ screen -S [SOLNAME]-integrator
$ cd integrator
$ npm run start
</code></pre></div><p>As an example, the process for launching the <code>ako-iot</code> solution would be:</p> <div class="language- extra-class"><pre class="language-text"><code>$ cd ako-iot
$ screen -S ako-api
$ cd api
$ npm run start
</code></pre></div><p>This will launch the api. After that we exit the session via <code>Ctrl+A+D</code> and then:</p> <div class="language- extra-class"><pre class="language-text"><code>$ screen -S ako-integrator
$ cd integrator
$ npm run start
</code></pre></div><p>This process should be repeated with the rest of solutions (<code>forge</code>, <code>google-calendar</code>, <code>jgpresence</code>, <code>manttest</code> and <code>wibeee</code>).</p> <h2 id="start-id-manager"><a href="#start-id-manager" class="header-anchor">#</a> Start ID Manager</h2> <p>After the individual solutions have been started it is time to start the ID manager. The process is similar to the one presented above for each of the solutions. In this case the <code>service</code> and <code>api</code> projects have to be started.</p> <div class="language- extra-class"><pre class="language-text"><code>$ cd ~/dev/id-manager
$ screen -S id-manager-service
$ cd service
$ npm run start
</code></pre></div><p><code>Ctrl+A+D</code> to exit the screen session and then:</p> <div class="language- extra-class"><pre class="language-text"><code>$ screen -S id-manager-api
$ cd api
$ npm run start
</code></pre></div><p>This is enough to start the ID manager.</p> <h2 id="start-viewer-api-and-integrators"><a href="#start-viewer-api-and-integrators" class="header-anchor">#</a> Start Viewer API and Integrators</h2> <p>After the ID manager it is time to start the viewer api and the integrators that enable communication between the viewer and the individual solutions. We will first start the integrators and after that, the api.</p> <div class="language- extra-class"><pre class="language-text"><code>$ cd ~/dev/@jgsmart/viewer
</code></pre></div><p>Once inside the <code>viewer</code> folder the projects that have to be started are: <code>ako-viewer-integrator</code>, <code>gcalendar-viewer-integrator</code>, <code>jgpresence-viewer-integrator</code>, <code>manttest-viewer-integrator</code>.</p> <p>The procedure to follow for each of these integrators is:</p> <div class="language- extra-class"><pre class="language-text"><code>$ screen -S [SOLUTION_NAME]-v-integrator
$ cd [SOLUTION_NAME]-viewer-integrator
$ npm run start
</code></pre></div><p><code>Ctrl+A+D</code> to exit the screen session and repeat until all the viewer-integrators are up and running. After the 4 integrators have been launched, start the api.</p> <div class="language- extra-class"><pre class="language-text"><code>$ screen -S viewer-api
$ cd api
$ npm run start
</code></pre></div><h2 id="launch-web"><a href="#launch-web" class="header-anchor">#</a> Launch web</h2> <p>Now that we have up and running:</p> <ul><li><code>ako-iot</code>, <code>forge</code>, <code>google-calendar</code>, <code>jgpresence</code>, <code>manttest</code> and <code>wibeee</code> apis and integrators</li> <li><code>id-manager</code> api and service</li> <li><code>ako-viewer-integrator</code>, <code>gcalendar-viewer-integrator</code>, <code>jgpresence-viewer-integrator</code>, <code>manttest-viewer-integrator</code> and the <code>viewer</code> api</li></ul> <p>it is time to launch the web. To do so,</p> <div class="language- extra-class"><pre class="language-text"><code>$ cd ~/dev/@jgsmart/jgsmart-web-demo
$ screen -S web
$ sudo npm run start
</code></pre></div><p>After entering the password the command output should look something like:</p> <div class="language- extra-class"><pre class="language-text"><code>user@JGSMART:~/dev/@jgsmart/jgsmart-web-demo$ sudo npm run start
[sudo] password for user:

&gt; jgsmart-web-demo@1.0.0 start /home/user/dev/@jgsmart/jgsmart-web-demo
&gt; cross-env NODE_ENV=production node server/index.js


 READY  Server listening on http://0.0.0.0:80
</code></pre></div><p>If everything went ok, accessing <a href="http://jgsmart.jgingenieros.es/" target="_blank" rel="noopener noreferrer">http://jgsmart.jgingenieros.es/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> with:</p> <ul><li>Username: jgallostraa</li> <li>Password: test</li></ul> <p>should let you log in into the platform, where everything should be working.</p> <h2 id="overview"><a href="#overview" class="header-anchor">#</a> Overview</h2> <p>A list of the screen sessions used for this tutorial can be found below. Use it to check that no steps were skipped and that all required sessions are there.</p> <div class="language- extra-class"><pre class="language-text"><code>user@JGSMART:~/dev/id-manager$ screen -ls
There are screens on:
        24070.id-manager-service        (30/11/20 12:12:11)     (Detached)
        21002.gc-api    (30/11/20 11:11:39)     (Detached)
        20958.gc-integrator     (30/11/20 11:11:23)     (Detached)
        20635.web       (30/11/20 11:05:13)     (Detached)
        20450.viewer-api        (30/11/20 11:00:33)     (Detached)
        20390.manttest-v-integrator     (30/11/20 11:00:16)     (Detached)
        20342.presence-v-integrator     (30/11/20 11:00:00)     (Detached)
        20273.gcalendar-v-integrator    (30/11/20 10:59:40)     (Detached)
        20228.ako-v-integrator  (30/11/20 10:59:27)     (Detached)
        20102.id-manager-api    (30/11/20 10:58:18)     (Detached)
        20042.wibeee-api        (30/11/20 10:57:28)     (Detached)
        19994.wibeee-integrator (30/11/20 10:57:14)     (Detached)
        19895.manttest-api      (30/11/20 10:56:13)     (Detached)
        19832.manttest-integrator       (30/11/20 10:55:54)     (Detached)
        19783.presence-api      (30/11/20 10:55:31)     (Detached)
        19689.presence-integrator       (30/11/20 10:54:50)     (Detached)
        19604.forge-api (30/11/20 10:54:22)     (Detached)
        19560.forge-integrator  (30/11/20 10:54:12)     (Detached)
        19502.ako-integrator    (30/11/20 10:53:21)     (Detached)
        19419.ako-api   (30/11/20 10:52:27)     (Detached)
        18318.docker    (30/11/20 10:47:33)     (Detached)
21 Sockets in /run/screen/S-user.
</code></pre></div><h2 id="troubleshooting"><a href="#troubleshooting" class="header-anchor">#</a> Troubleshooting</h2> <p>If everything seems to be working (indicators, plots, etc.) but nothing is highlighted in the viewer try to restart both the api and service of the ID manager.</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.d9661c25.js" defer></script><script src="/assets/js/2.d35fa273.js" defer></script><script src="/assets/js/13.4ac1dcd4.js" defer></script>
  </body>
</html>
